## T1546.013 - Event Triggered Execution: PowerShell Profile
We're gonna talk about the sub-technique T1546.013 from MITRE ATT&CK which is named 'PowerShell Profile' under T1546:Event Triggerd Execution. This thing is mainly used by attackers to stay in a system called persistence, but sometimes they also use it for privilege escalation. I will try to explain it in easy way.

what a PowerShell profile actually is?
It’s just a script file — usually named 'profile.ps1'. This script runs automatically whenever someone opens PowerShell. So now you can guess -if an attacker adds some malicious commands or programs inside this script, it will become a malicious profile.ps1. That means, whenever the victim opens PowerShell, the attacker's malicious script will also run automatically.

Imagine the attacker has written a 'reverse shell script' inside the profile.ps1. So every time the victim opens PowerShell, the attacker gets access to the victim’s shell.

That’s why this technique gives the attacker two benefits:

1. Persistence - Even if the attacker loses access, attacker will get it back again when the victim will open PowerShell again.
2. Privilege escalation - If the victim runs PowerShell as an administrator, the attacker will get the admin console meaning the attacker will get access to the system with admin rights too.

### Practical demo:
Let’s try a simple demo using this technique. we’ll make it run a trusted app like Calculator (calc.exe) when PowerShell opens.


#### Step 1: Find where the PowerShell profile file is

There are actually 4 different types of profile script. Script for -
1. AllUsersAllHosts
2. CurrentUserCurrentHost
3. CurrentUserAllHosts
4. AllUsersCurrentHost

To check the main profile for your current user and host, use this command:
`$PROFILE | Select *`
![My Screenshot](https://github.com/sami-tarif/Screenshots/blob/main/T1546.013/Screenshot1.png)

This shows you where the profile.ps1 file is. If you want to see other types of profile scripts (like for all users), try:
`$PROFILE.AllUsersAllHosts | Format-List *`
![My Screenshot](https://github.com/sami-tarif/Screenshots/blob/main/T1546.013/Screenshot2.png)


So now you can find out the location of the profile file, and whether it already exists.


#### Step 2: Add code to run calc.exe from the profile script

Use this command:
`echo "Start-Process calc.exe" > $PROFILE`
This writes the command into your profile script so that it runs Calculator process when PowerShell opens.

You can check what’s inside the script like this:
`cat $PROFILE`
![My Screenshot](https://github.com/sami-tarif/Screenshots/blob/main/T1546.013/Screenshot3.png)


#### Step 3: Close and reopen PowerShell

Now open PowerShell again — you’ll see that Calculator opens automatically.
![My Screenshot](https://github.com/sami-tarif/Screenshots/blob/main/T1546.013/Screenshot4.png)

Attackers can do the same thing, but instead of calc.exe, they’ll add malicious scripts or payloads.

So that’s how attackers can use the PowerShell profile for persistence and even privilege escalation, depending on how the victim runs PowerShell.
